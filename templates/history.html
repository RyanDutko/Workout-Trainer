
{% extends "base.html" %}

{% block title %}History - Personal Trainer{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2"><i class="fas fa-history me-2"></i>Workout History</h1>
</div>

<div class="card">
    <div class="card-body">
        <div id="loading" class="text-center py-4">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2">Loading workout history...</p>
        </div>
        
        <div id="history-content" style="display: none;">
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Exercise</th>
                            <th>Sets</th>
                            <th>Reps</th>
                            <th>Weight</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody id="workout-table-body">
                    </tbody>
                </table>
            </div>
        </div>
        
        <div id="no-workouts" style="display: none;">
            <p class="text-muted">No workout history found. Start logging workouts to see them here!</p>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    loadWorkoutHistory();
});

function loadWorkoutHistory() {
    fetch('/get_all_workouts')
        .then(response => response.json())
        .then(data => {
            const loading = document.getElementById('loading');
            const content = document.getElementById('history-content');
            const noWorkouts = document.getElementById('no-workouts');
            const tableBody = document.getElementById('workout-table-body');
            
            loading.style.display = 'none';
            
            if (data && data.length > 0) {
                content.style.display = 'block';
                
                // Clear existing rows
                tableBody.innerHTML = '';
                
                // Add workout rows
                data.forEach(workout => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${workout.date_logged}</td>
                        <td>${workout.exercise_name}</td>
                        <td>${workout.sets}</td>
                        <td>${workout.reps}</td>
                        <td>${workout.weight}</td>
                        <td>${workout.notes || ''}</td>
                    `;
                    tableBody.appendChild(row);
                });
            } else {
                noWorkouts.style.display = 'block';
            }
        })
        .catch(error => {
            console.error('Error loading workout history:', error);
            document.getElementById('loading').innerHTML = '<p class="text-danger">Error loading workout history. Please refresh the page.</p>';
        });
}
</script>
{% endblock %}
